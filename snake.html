<!DOCTYPE html>
<html>
<head>
<style>	
body {padding: 0; margin: 0; overflow: hidden;}


</style>
</head>
<body>
	<canvas id='mycanvas'></canvas>
<script>
'use strict'

function Snake(canvas, options) {
	var defaults = {
		canvasColor: 'black',
		snakeColor: 'white',
		startLength: 10,
		rectSize: 10,
		speed: 40,
	};

	this.canvas = document.getElementById(canvas);
	this.ctx = this.canvas.getContext('2d');
	this.snake = [];
	this.food = {};
	this.options = options || defaults;

	window.addEventListener('load', this, false);
}

Snake.fn = Snake.prototype;

Snake.fn.init = function() {
	this.setCanvas();
	this.paintCanvas();
	this.initSnake();
	this.paintSnake();
	this.initFood();
	this.paintFood();
}

Snake.fn.handleEvent = function() {
	this.init();
}

Snake.fn.h = function() {
	return window.innerHeight;
}

Snake.fn.w = function() {
	return window.innerWidth;
}

Snake.fn.setCanvas = function() {
	this.canvas.height = this.h();
	this.canvas.width = this.w();
}

Snake.fn.paintCanvas = function() {
	this.ctx.fillStyle = this.options.canvasColor;
	this.ctx.fillRect(0, 0, this.w(), this.h());
}

Snake.fn.initSnake = function() {
	var len = this.options.startLength;
	var s = this.snake;

	for (var i = len - 1; i >= 0; i--) {
		s.push({x: i, y: 0});
	}
}

Snake.fn.initFood = function() {
	this.food = {
		x: Math.round(Math.random() * (this.w() - this.options.rectSize) / this.options.rectSize),
		y: Math.round(Math.random() * (this.h() - this.options.rectSize) / this.options.rectSize)
	};
}

Snake.fn.paintSnake = function() {
	var size = this.options.rectSize;
	var s = this.snake;

	// take coordinate and paint rect
	for (var i = 0; i < this.snake.length; i++) {
		this.ctx.fillStyle = this.options.snakeColor;	
		this.ctx.fillRect(s[i].x * size, s[i].y * size, size, size);
	}
}

Snake.fn.paintFood = function() {
	var size = this.options.rectSize;
	this.ctx.fillStyle = 'white';
	this.ctx.fillRect(this.food.x * size, this.food.y * size, size, size);
}

var dir = 'right';
var over = 0;

Snake.fn.updateSnake = function() {
	// get head coordinates
	var s = this.snake;
	var headX = s[0].x;
	var headY = s[0].y;
	var o = this.options;
	var size = this.options.rectSize;

	document.onkeydown = function(e) {
		var key = e.keyCode;

		if(key === 37 && dir !== "right") {
        	setTimeout(function() {
            	dir = "left"; 
        	}, o.speed);
      	} else if(key === 38 && dir !== "down") {
        	setTimeout(function() {
            	dir = "up"; 
        	}, o.speed)
      	} else if(key === 39 && dir !== "left") {
        	setTimeout(function() {
            	dir = "right"; 
        	}, o.speed)
      	} else if(key === 40 && dir !== "up") {
        	setTimeout(function() {
            	dir = "down"; 
        	}, o.speed)
      	}

      	e.preventDefault();
	}

	// based on key direction, add to coordinates 
	switch (dir) {
		case 'right':
			headX++;
			break;
		case 'left':
			headX--;
			break;
		case 'up':
			headY--;
			break;
		case 'down':
			headY++;
			break;
	}

	this.ctx.fillStyle = 'black';
	this.ctx.fillRect(s[s.length - 1 ].x * size, s[s.length - 1].y * size, size, size);

	// takes last square and puts it in front
	var tail = s.pop();
    tail.x = headX;
    tail.y = headY;
    s.unshift(tail);

	this.ctx.fillStyle = this.options.snakeColor;
    this.ctx.fillRect(s[0].x * size, s[0].y * size, size, size);

    var f = this.food;

    // collision
    for (var j = 1; j < s.length; j++) {
    	if (headX === s[j].x && headY === s[j].y) {
    		clearInterval(start);
        }
    } 

    if (headX === f.x && headY === f.y) {
        this.initFood();
        var tail = {x: headX, y: headY};
      	s.unshift(tail);  
    }

    if (headX >= this.w() / o.rectSize || headX <= -1 || headY >= this.h() / o.rectSize || headY <= -1) {

    	if (over === 0) {
    	clearInterval(start);
    	}
    	over++;
    }
}






Snake.fn.paint = function() {
	// this.paintCanvas();
	this.updateSnake();
	// this.paintSnake();
	this.paintFood();
}





var snake = new Snake('mycanvas');

var start = setInterval(function() {
	snake.paint();
}, snake.options.speed);





</script>
</body>
</html>






















