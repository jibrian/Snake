<!DOCTYPE html>
<html>
<head>
<style>	
#mycanvas {
	border: 1px solid black;
}

canvas,
body,
html {
	margin: 0;
	padding: 0;
}
</style>
</head>
<body>
	<canvas id='mycanvas' width='500' height='500'></canvas>
<script>
'use strict'

function Snake(canvas, options) {
	var defaults = {
		canvasColor: 'black',
		snakeColor: 'white',
		startLength: 10,
		rectSize: 10,
		speed: 40,
	};

	this.options = options || defaults;
	this.canvas = document.getElementById(canvas);
	this.ctx = this.canvas.getContext('2d');
	this.snake = [];
	this.food = {};

	window.addEventListener('load', this, false);
}

Snake.fn = Snake.prototype;

Snake.fn.init = function() {
	this.setCanvas();
	this.initSnake();
	this.initFood();
}

Snake.fn.handleEvent = function() {
	this.init();
}

Snake.fn.h = function() {
	return window.innerHeight;
}

Snake.fn.w = function() {
	return window.innerWidth;
}

Snake.fn.setCanvas = function() {
	this.canvas.height = this.h();
	this.canvas.width = this.w();
}

Snake.fn.paintCanvas = function() {
	this.ctx.fillStyle = this.options.canvasColor;
	this.ctx.fillRect(0, 0, this.w(), this.h());
}

Snake.fn.initSnake = function() {
	var len = this.options.startLength;
	var s = this.snake;

	// load snake with coordinate objects from head to tail
	for (var i = len - 1; i >= 0; i--) {
		s.push({x: i, y: 0});
	}
}

Snake.fn.initFood = function() {
	this.food = {
		x: Math.round(Math.random() * (this.w() - this.options.rectSize) / this.options.rectSize),
		y: Math.round(Math.random() * (this.h() - this.options.rectSize) / this.options.rectSize)
	};
}

Snake.fn.paintSnake = function() {
	var size = this.options.rectSize;
	var s = this.snake;

	// take coordinate and paint rect
	for (var i = 0; i < this.snake.length; i++) {
		if (i === 0) {
			this.ctx.fillStyle = 'red';
		} else {
			this.ctx.fillStyle = this.options.snakeColor;	
		}

		this.ctx.fillRect(s[i].x * size, s[i].y * size, size, size);
	}
}

var dir = 'right';
var over = 0;

Snake.fn.updateSnake = function() {
	// get head coordinates
	var s = this.snake;
	var headX = s[0].x;
	var headY = s[0].y;
	var o = this.options;

	document.onkeydown = function(e) {
		var key = e.keyIdentifier;

		if(key === 'Left' && dir !== "right") {
        	setTimeout(function() {
            	dir = "left"; 
        	}, o.speed);
      	} else if(key === 'Up' && dir !== "down") {
        	setTimeout(function() {
            	dir = "up"; 
        	}, o.speed)
      	} else if(key === 'Right' && dir !== "left") {
        	setTimeout(function() {
            	dir = "right"; 
        	}, o.speed)
      	} else if(key === 'Down' && dir !== "up") {
        	setTimeout(function() {
            	dir = "down"; 
        	}, o.speed)
      	}

      	e.preventDefault();
	}

	// based on key direction, add to coordinates 
	switch (dir) {
		case 'right':
			headX++;
			break;
		case 'left':
			headX--;
			break;
		case 'up':
			headY--;
			break;
		case 'down':
			headY++;
			break;
	}

	// ? this is the money
	var tail = s.pop();
    tail.x = headX;
    tail.y = headY;
    s.unshift(tail);

    var f = this.food;

    // collision
    for (var j = 1; j < s.length; j++) {
    	if (headX === s[j].x && headY === s[j].y) {
            alert('asd')
        }

        if (headX === f.x && headY === f.y) {
        	this.initFood();
        }
    } 

   

}

Snake.fn.draw = function() {
	this.paintCanvas();
	this.paintSnake();
	this.updateSnake();
	this.paintFood();
}

Snake.fn.paintFood = function() {
	var size = this.options.rectSize;
	this.ctx.fillStyle = 'white';
	this.ctx.fillRect(this.food.x * size, this.food.y * size, size, size);
}









var snake = new Snake('mycanvas');

setInterval(function() {
	snake.draw();
}, snake.options.speed);




</script>
</body>
</html>






















